{
  "version": 3,
  "sources": ["../../../src/background/index.ts"],
  "sourcesContent": ["const index = new Map<string, any>();\n\ntype Meta = {\n  url: string;\n  tabId: number;\n};\n\nconst indexAdd = (meta: Meta, content: string) => {\n  index.set(meta.url, { content, meta });\n};\n\nconst search = (key: string) => {\n  const searchResult = [];\n  for (let entry of Array.from(index.entries())) {\n    let url = entry[0];\n    let value = entry[1];\n    let foundPosition = value.content.indexOf(key);\n    if (foundPosition !== -1) {\n      searchResult.push({\n        url,\n        meta: value.meta,\n        matchString: value.content.substring(\n          foundPosition - 100,\n          foundPosition + 100\n        ),\n      });\n    }\n  }\n  return searchResult;\n};\n\nfunction insertContentScript(tab: chrome.tabs.Tab) {\n  chrome.scripting\n    .executeScript({\n      target: { tabId: tab.id || 0 },\n      files: [\"dist/content/index.js\"],\n    })\n    .then(() => {\n      console.log(\"INJECTED THE FOREGROUND SCRIPT.\");\n    })\n    .catch((err) => console.log(err));\n}\n\ntry {\n  console.log(\"background Script\");\n  chrome.tabs.query({}, (tabs) => {\n    tabs.forEach(insertContentScript);\n  });\n  chrome.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {\n    if (changeInfo.status === \"complete\" && /^http/.test(tab?.url || \"\")) {\n      insertContentScript(tab);\n    }\n  });\n\n  chrome.runtime.onMessage.addListener(function (\n    request,\n    sender,\n    sendResponse\n  ) {\n    switch (request.type) {\n      case \"index\":\n        {\n          const meta = {\n            url: request.url,\n            tabId: sender.tab?.id || 0,\n          };\n          indexAdd(meta, request.content);\n          sendResponse(\"indexed\");\n        }\n        break;\n      case \"search\": {\n        const key = request.key;\n        sendResponse(search(key));\n      }\n    }\n  });\n} catch (e) {\n  console.log(e);\n}\n"],
  "mappings": "mBAAA,IAAMA,EAAQ,IAAI,IAOZC,EAAW,CAACC,EAAYC,IAAoB,CAChDH,EAAM,IAAIE,EAAK,IAAK,CAAE,QAAAC,EAAS,KAAAD,CAAK,CAAC,CACvC,EAEME,EAAUC,GAAgB,CAC9B,IAAMC,EAAe,CAAC,EACtB,QAASC,KAAS,MAAM,KAAKP,EAAM,QAAQ,CAAC,EAAG,CAC7C,IAAIQ,EAAMD,EAAM,CAAC,EACbE,EAAQF,EAAM,CAAC,EACfG,EAAgBD,EAAM,QAAQ,QAAQJ,CAAG,EACzCK,IAAkB,IACpBJ,EAAa,KAAK,CAChB,IAAAE,EACA,KAAMC,EAAM,KACZ,YAAaA,EAAM,QAAQ,UACzBC,EAAgB,IAChBA,EAAgB,GAClB,CACF,CAAC,EAGL,OAAOJ,CACT,EAEA,SAASK,EAAoBC,EAAsB,CACjD,OAAO,UACJ,cAAc,CACb,OAAQ,CAAE,MAAOA,EAAI,IAAM,CAAE,EAC7B,MAAO,CAAC,uBAAuB,CACjC,CAAC,EACA,KAAK,IAAM,CACV,QAAQ,IAAI,iCAAiC,CAC/C,CAAC,EACA,MAAOC,GAAQ,QAAQ,IAAIA,CAAG,CAAC,CACpC,CAEA,GAAI,CACF,QAAQ,IAAI,mBAAmB,EAC/B,OAAO,KAAK,MAAM,CAAC,EAAIC,GAAS,CAC9BA,EAAK,QAAQH,CAAmB,CAClC,CAAC,EACD,OAAO,KAAK,UAAU,YAAY,CAACI,EAAOC,EAAYJ,IAAQ,CACxDI,EAAW,SAAW,YAAc,QAAQ,MAAKJ,GAAA,YAAAA,EAAK,MAAO,EAAE,GACjED,EAAoBC,CAAG,CAE3B,CAAC,EAED,OAAO,QAAQ,UAAU,YAAY,SACnCK,EACAC,EACAC,EACA,CA1DJ,IAAAC,EA2DI,OAAQH,EAAQ,KAAM,CACpB,IAAK,QACH,CACE,IAAMf,EAAO,CACX,IAAKe,EAAQ,IACb,QAAOG,EAAAF,EAAO,MAAP,YAAAE,EAAY,KAAM,CAC3B,EACAnB,EAASC,EAAMe,EAAQ,OAAO,EAC9BE,EAAa,SAAS,CACxB,CACA,MACF,IAAK,SAAU,CACb,IAAMd,EAAMY,EAAQ,IACpBE,EAAaf,EAAOC,CAAG,CAAC,CAC1B,CACF,CACF,CAAC,CACH,OAASgB,EAAP,CACA,QAAQ,IAAIA,CAAC,CACf",
  "names": ["index", "indexAdd", "meta", "content", "search", "key", "searchResult", "entry", "url", "value", "foundPosition", "insertContentScript", "tab", "err", "tabs", "tabId", "changeInfo", "request", "sender", "sendResponse", "_a", "e"]
}
